<!DOCTYPE html>
<head>
  <title>Unreal Control Panel</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <h1 class="h1">Testing Interface</h1>

  <button type="submit" class="button" formaction="http://localhost:30010/remote/presets" formmethod="GET">Click Me!</button>

  <div class="slidecontainer">
    <input type="range" min="1" max="100" value="50" class="slider" id="slider1" onchange="sendMessage(this.value)">
  </div>



  <script>

    var connection = null;

          
    window.onload = function() {
      console.log("Starting test")
      connection = new WebSocket('ws://127.0.0.1:30020');
      connection.onopen = function () {
          document.getElementById("status").innerHTML = "Connection Open";};
      connection.onerror = function (error) {};
      connection.onmessage = function (message) {
          if (message.data instanceof Blob) {
              reader = new FileReader();
              reader.onload = () => {
                  let holder = document.getElementById("holder");
                  let par = document.createElement("pre");
                  par.style = style="white-space: pre-line";
                  let json = JSON.parse(reader.result);
                  let text = json.Type;
                  par.innerHTML = text;
                  holder.appendChild(par);
                  console.log(reader.result)
              };
              reader.readAsText(message.data);
          } else {}
      };
      connection.onclose = function(event) {
        console.log("WebSocket is closed now.");
      };
    }
  
  
    function sendMessage() {

      var speed = document.getElementById('in').value;
                var float = parseFloat(value);
                console.log(float);
                
                const registerPayload = {
                    "MessageName": "http",
                    "Parameters": {
                        "Url": "/remote/object/call",
                        "Verb": "PUT",
                        "Body": {
                            "ObjectPath": "/Game/Train_Station/StartStationMapVR.StartStationMapVR:PersistentLevel.WebComms_C_1",
                            "functionName": "ReturnLevelInfo",
                            "parameters" : {
                            "FogSpeed": {"X" : 0, "Y" : float, "Z" : 0} 
                                },
                            "generateTransaction":true
                            }
                        }
                };
                connection.send(JSON.stringify(registerPayload));

    }



  </script>
</body>
</html>
